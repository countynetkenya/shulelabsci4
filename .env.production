#--------------------------------------------------------------------
# ShuleLabs CI4 - PRODUCTION Environment Configuration
#--------------------------------------------------------------------
# SECURITY WARNING: Never commit this file to version control!
# Copy to .env and update with production values
#--------------------------------------------------------------------

#--------------------------------------------------------------------
# ENVIRONMENT
#--------------------------------------------------------------------
CI_ENVIRONMENT = production

#--------------------------------------------------------------------
# APP
#--------------------------------------------------------------------
app.baseURL = 'https://shulelabs.com/'
app.indexPage = ''
app.appTimezone = 'Africa/Nairobi'
app.defaultLocale = 'en'
app.negotiateLocale = false
app.supportedLocales = ['en']
app.forceGlobalSecureRequests = true
app.proxyIPs = ''
app.CSPEnabled = true

#--------------------------------------------------------------------
# DATABASE
#--------------------------------------------------------------------
database.default.hostname = localhost
database.default.database = shulelabs_production
database.default.username = shulelabs_user
database.default.password = REPLACE_WITH_STRONG_PASSWORD
database.default.DBDriver = MySQLi
database.default.DBPrefix = ci4_
database.default.port = 3306
database.default.charset = utf8mb4
database.default.DBCollat = utf8mb4_general_ci
database.default.strictOn = true
database.default.failover = []

#--------------------------------------------------------------------
# DATABASE BACKUP CONNECTION
#--------------------------------------------------------------------
database.backup.hostname = backup-server.example.com
database.backup.database = shulelabs_backup
database.backup.username = backup_user
database.backup.password = REPLACE_WITH_BACKUP_PASSWORD
database.backup.DBDriver = MySQLi
database.backup.DBPrefix = ci4_
database.backup.port = 3306

#--------------------------------------------------------------------
# ENCRYPTION
#--------------------------------------------------------------------
encryption.key = REPLACE_WITH_32_BYTE_HEX_KEY
encryption.driver = OpenSSL
encryption.blockSize = 16
encryption.digest = SHA512

#--------------------------------------------------------------------
# SESSION
#--------------------------------------------------------------------
session.driver = 'CodeIgniter\Session\Handlers\DatabaseHandler'
session.cookieName = 'shulelabs_session'
session.expiration = 7200
session.savePath = 'ci4_sessions'
session.matchIP = false
session.timeToUpdate = 300
session.regenerateDestroy = false
session.sameSite = 'Lax'

#--------------------------------------------------------------------
# COOKIE
#--------------------------------------------------------------------
cookie.prefix = 'shulelabs_'
cookie.expires = 0
cookie.path = '/'
cookie.domain = '.shulelabs.com'
cookie.secure = true
cookie.httponly = true
cookie.samesite = 'Lax'
cookie.raw = false

#--------------------------------------------------------------------
# SECURITY
#--------------------------------------------------------------------
security.csrfProtection = 'session'
security.tokenRandomize = true
security.tokenName = 'csrf_token'
security.headerName = 'X-CSRF-TOKEN'
security.cookieName = 'csrf_cookie'
security.expires = 7200
security.regenerate = true
security.redirect = false
security.samesite = 'Lax'

#--------------------------------------------------------------------
# CORS
#--------------------------------------------------------------------
cors.allowedOrigins = ['https://shulelabs.com', 'https://www.shulelabs.com']
cors.allowedOriginsPatterns = []
cors.allowedMethods = ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS']
cors.allowedHeaders = ['Content-Type', 'Authorization', 'X-Requested-With', 'X-CSRF-TOKEN']
cors.exposedHeaders = []
cors.maxAge = 7200
cors.supportsCredentials = true

#--------------------------------------------------------------------
# EMAIL
#--------------------------------------------------------------------
email.protocol = smtp
email.SMTPHost = smtp.gmail.com
email.SMTPUser = noreply@shulelabs.com
email.SMTPPass = REPLACE_WITH_EMAIL_PASSWORD
email.SMTPPort = 587
email.SMTPCrypto = tls
email.SMTPTimeout = 5
email.mailType = html
email.charset = utf-8
email.wordWrap = true
email.fromEmail = noreply@shulelabs.com
email.fromName = 'ShuleLabs Platform'

#--------------------------------------------------------------------
# CACHE
#--------------------------------------------------------------------
cache.handler = redis
cache.storePath = writable/cache/
cache.redis.host = 127.0.0.1
cache.redis.password = REPLACE_WITH_REDIS_PASSWORD
cache.redis.port = 6379
cache.redis.timeout = 0
cache.redis.database = 0

#--------------------------------------------------------------------
# LOGGER
#--------------------------------------------------------------------
logger.threshold = 4
logger.handlers = ['file', 'errorlog']
logger.file.path = /var/log/shulelabs/
logger.file.dateFormat = 'Y-m-d H:i:s'

#--------------------------------------------------------------------
# PAYMENT GATEWAYS
#--------------------------------------------------------------------
# M-Pesa Configuration
mpesa.consumerKey = REPLACE_WITH_MPESA_CONSUMER_KEY
mpesa.consumerSecret = REPLACE_WITH_MPESA_CONSUMER_SECRET
mpesa.shortcode = 174379
mpesa.passkey = REPLACE_WITH_MPESA_PASSKEY
mpesa.environment = production
mpesa.callbackURL = https://shulelabs.com/api/payments/mpesa/callback

# PayPal Configuration
paypal.mode = live
paypal.clientID = REPLACE_WITH_PAYPAL_CLIENT_ID
paypal.clientSecret = REPLACE_WITH_PAYPAL_CLIENT_SECRET
paypal.webhookID = REPLACE_WITH_PAYPAL_WEBHOOK_ID

#--------------------------------------------------------------------
# SMS GATEWAY
#--------------------------------------------------------------------
sms.provider = africastalking
sms.apiKey = REPLACE_WITH_SMS_API_KEY
sms.username = REPLACE_WITH_SMS_USERNAME
sms.from = SHULELABS

#--------------------------------------------------------------------
# STORAGE
#--------------------------------------------------------------------
storage.driver = s3
storage.s3.key = REPLACE_WITH_AWS_ACCESS_KEY
storage.s3.secret = REPLACE_WITH_AWS_SECRET_KEY
storage.s3.region = us-east-1
storage.s3.bucket = shulelabs-uploads
storage.s3.url = https://s3.amazonaws.com/shulelabs-uploads

#--------------------------------------------------------------------
# MONITORING
#--------------------------------------------------------------------
# Sentry for error tracking
sentry.dsn = REPLACE_WITH_SENTRY_DSN
sentry.environment = production

# New Relic APM
newrelic.appname = ShuleLabs Production
newrelic.license = REPLACE_WITH_NEWRELIC_LICENSE

#--------------------------------------------------------------------
# FEATURE FLAGS
#--------------------------------------------------------------------
feature.maintenance = false
feature.registration = true
feature.multiSchool = true
feature.mobileAPI = true
feature.payments = true
feature.sms = true
feature.emailNotifications = true

#--------------------------------------------------------------------
# RATE LIMITING
#--------------------------------------------------------------------
ratelimit.enabled = true
ratelimit.requests = 100
ratelimit.period = 60

#--------------------------------------------------------------------
# BACKUP
#--------------------------------------------------------------------
backup.enabled = true
backup.schedule = '0 2 * * *'
backup.retention = 30
backup.destination = s3://shulelabs-backups/
